#!/usr/bin/env python

import os, sys
from StringIO import StringIO
from testify import *

os.chdir(os.path.dirname(__file__))

@test
def expectPass():
  expect(1)

  sys.argv = [sys.argv[0], 'data/expectPass']

  save = sys.stdout
  sys.stdout = StringIO()

  execfile('../testify', {})

  stdout = sys.stdout
  sys.stdout = save

  equal('''1..1
ok 1
''', stdout.getvalue())

@test
def expectFail():
  expect(1)

  sys.argv = [sys.argv[0], 'data/expectFail']

  save = sys.stdout
  sys.stdout = StringIO()

  execfile('../testify', {})

  stdout = sys.stdout
  sys.stdout = save

  equal('''1..1
not ok 1 "Not" "Equal"
''', stdout.getvalue())

@test
def notExpect():
  expect(1)

  sys.argv = [sys.argv[0], 'data/notExpect']

  save = sys.stdout
  sys.stdout = StringIO()

  execfile('../testify', {})

  stdout = sys.stdout
  sys.stdout = save

  equal('''1..1
FAIL 1 0
''', stdout.getvalue())
